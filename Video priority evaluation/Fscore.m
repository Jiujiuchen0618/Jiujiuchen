%proposed-QoC  QoC  QoE  对比 
clc;
clear all;

%不同QP值的
% diff=[-3.85280001e+00 -3.85280001e+00 -3.64187633e+00 -3.30158824e+00...
%  -2.92633568e+00 -2.55387562e+00 -2.37941220e+00 -2.13792720e+00...
%  -1.97409756e+00 -1.78510697e+00 -1.61256483e+00 -1.41677440e+00...
%  -1.27541156e+00 -1.18854109e+00 -1.06423883e+00 -9.68557591e-01...
%  -9.05713618e-01 -8.31711053e-01 -7.47810083e-01 -7.09731184e-01...
%  -6.50271080e-01 -5.92157505e-01 -5.79136725e-01 -5.39005103e-01...
%  -5.12054474e-01 -5.21417303e-01 -5.01177885e-01 -5.26700049e-01...
%  -4.85162370e-01 -5.01307765e-01 -5.18222514e-01 -5.09091217e-01...
%  -4.88159699e-01 -4.89529403e-01 -5.12698273e-01 -5.15611419e-01...
%  -5.22649224e-01 -4.81159762e-01 -4.75681889e-01 -4.63409590e-01...
%  -4.42170897e-01 -3.84403062e-01 -3.20197930e-01 -3.10992851e-01...
%  -3.27420216e-01 -2.94738690e-01 -2.99427374e-01 -2.87902385e-01...
%  -2.63542817e-01 -2.45334669e-01 -2.35242767e-01 -2.05349079e-01...
%  -1.32026425e-01 -5.70619207e-02 -2.76805653e-02 -1.98891434e-02...
%  -2.35276064e-02 -2.44150896e-02 -5.02621578e-02 -1.04171330e-01...
%  -1.29755831e-01 -2.07475949e-01 -2.34461071e-01 -2.77182535e-01...
%  -2.87218604e-01 -2.75438768e-01 -2.55876792e-01 -2.07451341e-01...
%  -1.20667996e-01 -4.44561651e-02 -4.18362323e-02  6.33179084e-02...
%   1.76971509e-01  2.53058515e-01  2.05451702e-01  1.85089614e-01...
%   1.33759971e-01  1.06262663e-01  1.03778723e-01  9.43159968e-02...
%   8.02709367e-02  3.39840341e-02  1.12605240e-02  3.09759987e-02...
%   1.02784051e-01  2.14028032e-01  3.08592437e-01  3.72162809e-01...
%   4.48975797e-01  6.48218429e-01  7.41336353e-01  8.43947562e-01...
%   9.63279830e-01  1.02575354e+00  1.09088067e+00  1.43616855e+00...
%   1.84412683e+00  1.89519479e+00  1.91448919e+00  2.05903762e+00...
%   2.13872584e+00  2.06590794e+00  2.02398227e+00  2.00104495e+00...
%   2.09613942e+00  2.16412790e+00  2.31902219e+00  2.25527687e+00...
%   2.08627475e+00  1.89186019e+00  1.63298893e+00  1.38910360e+00...
%   1.17331760e+00  9.85345003e-01  7.96368045e-01  6.31268619e-01...
%   4.86576626e-01  3.29176666e-01  1.81349042e-01  5.72753399e-02...
%  -5.30533887e-02 -1.74662829e-01 -2.99619076e-01 -4.01850856e-01...
%  -5.03003233e-01 -6.09379875e-01 -7.19404763e-01 -7.79484338e-01...
%  -6.28519501e-01 -4.39869051e-01 -2.95758002e-01 -1.34258756e-01...
%   2.79462998e-02  2.08626375e-01  4.00613118e-01  6.12839656e-01...
%   6.73721411e-01  7.61128987e-01  7.79019058e-01  1.18040447e+00...
%   1.14868919e+00  1.15153645e+00  1.33020207e+00  1.36432684e+00...
%   1.33284040e+00  1.29722063e+00  1.28991443e+00  1.23084052e+00...
%   1.26760882e+00  1.36964857e+00  1.36256757e+00  1.28662412e+00...
%   1.14673944e+00  1.01035133e+00  8.60169692e-01  7.20324259e-01...
%   5.99328606e-01  6.30889700e-01  5.93413299e-01  4.49833063e-01...
%   2.63192197e-01  1.42769462e-01  6.70437646e-03 -8.06351961e-02...
%   1.03646202e-03 -3.58209137e-02 -1.06987853e-01 -2.06078714e-01...
%  -3.09201749e-01 -3.74797713e-01 -4.63412411e-01 -4.77155165e-01...
%  -5.13495163e-01 -8.74869924e-02 -4.25867041e-02 -1.55473179e-01...
%   1.33804516e-01  1.57087148e-01  3.48714734e-02  1.97307004e-01...
%  -4.40241563e-02 -1.47303945e-01 -1.45452615e-01 -1.60011379e-01...
%  -2.00951356e-01 -2.99373491e-01 -4.65878749e-01 -5.89638514e-01...
%   5.40101937e-02 -9.59129027e-02 -2.13076516e-01 -3.13095748e-01...
%  -4.04222507e-01 -4.79758504e-01 -2.73599887e-01 -2.68614841e-01...
%  -2.08320786e-01 -3.69348672e-01 -5.19734982e-01 -5.50951116e-01...
%  -5.29207467e-01 -4.86418427e-01 -5.49140503e-01 -6.36813916e-01...
%  -2.04669720e-01 -3.47831983e-01 -4.86587433e-01 -6.64774084e-01...
%  -8.40262693e-01 -9.41228016e-01 -8.00088121e-01  7.11249084e-01...
%   8.76364790e-01  5.89457951e-01  3.45378543e-01  1.24100098e-01...
%  -8.85977717e-02 -1.85639149e-01 -1.63285738e-01 -2.90458827e-01...
%   4.83503827e-01  2.04513587e-01];
diff1=importdata('12_15.txt');
diff2=importdata('12_25.txt');
diff3=importdata('12_45.txt');

L=length(diff1);

%计数器
c1=0;
c2=0;
c3=0;

for i=1:1:L
    if diff1(i)>0
        F1(i)=diff1(i);
        c1=c1+1;
    else
        F1(i)=0;
    end
    if diff2(i)>0
        F2(i)=diff2(i);
        c2=c2+1;
    else
        F2(i)=0;
    end
    if diff3(i)>0
        F3(i)=diff3(i);
        c3=c3+1;
    else
        F3(i)=0;
    end
end
x=1:1:L;
F_score1=F1./(max(F1));
F_score2=F2./(max(F2));
F_score3=F3./(max(F3));
% F_score3=F3*(sum(F3)/(c3*max(F3)));
I=imread('D:\caltech data\keyframes_extraction\frames\12\100.jpg');

figure(1)
plot(x,diff1,'r','LineWidth',2,'MarkerSize',6')
hold on;
plot(x,diff2,'r--','LineWidth',2,'MarkerSize',6')
plot(x,diff3,'b','LineWidth',2,'MarkerSize',6')
box on;
xlabel('Frame index')
ylabel('Diff')
axis([0 L+1 -4 2.5])

figure(2)
a1=74;
a2=190;
b1=0;
b2=1;
a=[a1 a2 a2 a1 a1];
b=[b1 b1 b2 b2 b1];
h=fill(a,b,'r','FaceColor',[1 0.8 0.8],'EdgeColor',[1 0.8 0.8]);
set(h,'edgealpha',1,'facealpha',0.3);
hold on;
plot(x,F_score1,'r','LineWidth',2,'MarkerSize',6')
%plot(x,F_score2,'b-','LineWidth',0.5,'MarkerSize',6')
plot(x,F_score3,'k-.','LineWidth',1,'MarkerSize',6')
box on;
grid on;
set(gcf,'unit','normalized','position',[0.3,0.3,0.26,0.18])
set(gca,'LooseInset',get(gca,'TightInset'))
xlabel('Frame index')
ylabel('F-score')
axis([0 L+1 0 1])
legend('ground truth','optimal allocation','normal allocation','location','Northwest')
ha=axes('units','normalized','position',[0.103 0.22 0.25 0.375]);
uistack(ha,'top');
image(I);
set(ha,'XTick', [], 'YTick', [] );
% set(gca,'position',[0.1,0.1,0.85,0.85] )
% set(gcf,'unit','normalized','position',[0.3,0.3,0.6,0.4])
% set(gca,'LooseInset',get(gca,'TightInset'))